(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{MKG8:function(e,t,a){"use strict";a.r(t);var i,n,r,l,o,s,c,p,d,u,m,h,f,v,k,E=a("eHn4"),g=a.n(E),y=(a("FJo9"),a("L41K")),b=(a("IzEo"),a("bx4M")),S=(a("14J3"),a("BMrR")),C=(a("jCWc"),a("kPKH")),N=a("jehZ"),I=a.n(N),F=(a("2qtc"),a("kLXV")),D=(a("5NDa"),a("5rEg")),w=(a("BoS7"),a("Sdc0")),O=(a("+L6B"),a("2/Rp")),_=(a("miYZ"),a("tsqr")),x=a("2Taf"),T=a.n(x),j=a("vZ4D"),B=a.n(j),J=a("l4Ni"),q=a.n(J),M=a("ujKo"),A=a.n(M),P=a("MhPg"),V=a.n(P),L=(a("y8nQ"),a("Vl3Y")),R=a("q1tI"),z=a.n(R),K=a("MuoO"),U=a("wd/R"),W=a.n(U),H=a("usdK"),Y=a("+kNj"),Z=a("Yaqk"),G=a("zHco"),Q=a("tpv8"),X=a.n(Q),$="academicSection",ee="authorDetailPublicStorage",te=function(e){var t=e[ee].task,a=e[ee].article,i=e[$].list,n=e[ee].step,r=e[ee].invoice;return{academicSec:i,article:a,invoice:r,step:n,task:t}},ae={labelCol:{span:5},wrapperCol:{span:19}},ie=(i=L["a"].create(),i((r=function(e){function t(e){var a;return T()(this,t),a=q()(this,A()(t).call(this,e)),a.onSubmit=function(){var e=a.state.isNeedInvoice,t=a.state.filename1.substr(a.state.filename1.lastIndexOf("."));if(e)a.props.form.validateFields(function(e,i){if(!e){var n={task:a.props.task,invoice:a.props.invoice};a.state.isNeedInvoice&&(n.invoice.receipt_title=i.receipt_title,n.invoice.address=i.address,n.invoice.format=t,n.invoice.receiver=i.receiver,n.invoice.receipt_num=i.receipt_num),n.invoice.flag=1==a.state.isNeedInvoice?1:0;var r=new FormData;r.append("all",JSON.stringify(n)),r.append("file",a.state.file1),fetch("/contribute/task/fill",{method:"POST",credentials:"include",header:{"Content-Type":"multipart/form-data"},body:r}).then(function(e){return e.json()}).then(function(e){1!=e.result?_["a"].error("\u901a\u4fe1\u5931\u8d25"):H["a"].push("/author/result")})}});else if(a.state.file1){var i={task:a.props.task,invoice:a.props.invoice};i.invoice.flag=1==a.state.isNeedInvoice?1:0;var n=new FormData;n.append("all",JSON.stringify(i)),n.append("file",a.state.file1),fetch("/contribute/task/fill",{method:"POST",credentials:"include",header:{"Content-Type":"multipart/form-data"},body:n}).then(function(e){return e.json()}).then(function(e){1!=e.result?_["a"].error("\u901a\u4fe1\u5931\u8d25"):H["a"].push("/author/result")})}},a.onChange=function(e){a.setState({isNeedInvoice:e})},a.checkValue=function(e,t,i){a.state.isNeedInvoice&&!t&&i("\u8bf7\u8f93\u5165\u5fc5\u8981\u7684\u6570\u636e"),i()},a.uploadFile1=function(e){e.preventDefault(),a.refs.uploadBox1.click()},a.onFileChange1=function(e){var t=e.target.files[0];a.setState({file1:t,filename1:t?t.name:null})},a.state={isNeedInvoice:!0,file1:void 0,filename1:void 0},a}return V()(t,e),B()(t,[{key:"render",value:function(){var e=this;return z.a.createElement(L["a"],I()({},ae,{hideRequiredMark:!0}),z.a.createElement(L["a"].Item,{label:"\u5ba1\u7a3f\u8d39\u91d1\u989d"},this.props.invoice.expense),z.a.createElement(L["a"].Item,{label:"\u4e0a\u4f20\u6c47\u6b3e\u5355\u56fe\u7247"},z.a.createElement(O["a"],{onClick:this.uploadFile1},"\u9009\u62e9\u6587\u4ef6")," ",z.a.createElement("br",null),this.state.filename1,z.a.createElement("input",{type:"file",id:"uploadFile1",name:"file1",onChange:this.onFileChange1,style:{display:"none"},ref:"uploadBox1",accept:".jpg"})),z.a.createElement(L["a"].Item,{label:"\u662f\u5426\u9700\u8981\u53d1\u7968"},z.a.createElement(w["a"],{checked:this.state.isNeedInvoice,onChange:this.onChange})),z.a.createElement(L["a"].Item,{label:"\u53d1\u7968\u62ac\u5934"},this.props.form.getFieldDecorator("receipt_title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53d1\u7968\u62ac\u5934"}]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d1\u7968\u62ac\u5934",disabled:!this.state.isNeedInvoice}))),z.a.createElement(L["a"].Item,{label:"\u7eb3\u7a0e\u4eba\u8bc6\u522b\u53f7"},this.props.form.getFieldDecorator("receipt_num",{rules:[{validator:this.checkValue}]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u7eb3\u7a0e\u4eba\u8bc6\u522b\u53f7",disabled:!this.state.isNeedInvoice}))),z.a.createElement(L["a"].Item,{label:"\u53d1\u7968\u90ae\u5bc4\u5730\u5740"},this.props.form.getFieldDecorator("address",{rules:[{validator:this.checkValue}]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d1\u7968\u90ae\u5bc4\u5730\u5740",disabled:!this.state.isNeedInvoice}))),z.a.createElement(L["a"].Item,{label:"\u53d1\u7968\u90ae\u5bc4\u6536\u4ef6\u4eba"},this.props.form.getFieldDecorator("receiver",{rules:[{validator:this.checkValue},,]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d1\u7968\u90ae\u5bc4\u6536\u4ef6\u4eba",disabled:!this.state.isNeedInvoice}))),z.a.createElement(O["a"],{type:"primary",onClick:function(){F["a"].confirm({title:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",content:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",onOk:function(){e.onSubmit()}})}},"\u63d0\u4ea4"))}}]),t}(z.a.Component),n=r))||n),ne=(l=L["a"].create(),l((s=function(e){function t(e){var a;return T()(this,t),a=q()(this,A()(t).call(this,e)),a.uploadFile1=function(e){e.preventDefault(),a.refs.uploadBox1.click()},a.uploadFile2=function(e){e.preventDefault(),a.refs.uploadBox2.click()},a.onFileChange1=function(e){var t=e.target.files[0];a.setState({file1:t,filename1:t?t.name:null})},a.onFileChange2=function(e){var t=e.target.files[0];a.setState({file2:t,filename2:t?t.name:null})},a.onSubmit=function(){a.props.form.validateFields(function(e,t){if(!e){var i=a.props.task;i.content=null;var n=new FormData;if(!a.state.filename1)return void _["a"].error("\u8bf7\u4e0a\u4f20\u6587\u7ae0\u6587\u4ef6");var r={};r.task=i,r.task.content=null,a.state.filename2&&""!=a.state.filename2?(n.append("file1",a.state.file1),n.append("file2",a.state.file2),n.append("all",JSON.stringify(r))):(n.append("file1",a.state.file1),n.append("all",JSON.stringify(r))),fetch("/contribute/upload_allocate",{method:"POST",credentials:"include",header:{"Content-Type":"multipart/form-data"},body:n}).then(function(e){return e.json()}).then(function(e){1==e.result?H["a"].push("/author/result"):_["a"].error("\u63d0\u4ea4\u9519\u8bef")})}})},a.state={file1:void 0,filename1:void 0,file2:void 0,filename2:void 0},a}return V()(t,e),B()(t,[{key:"render",value:function(){var e=this;return z.a.createElement(L["a"],{layout:"vertical",hideRequiredMark:!0},z.a.createElement(L["a"].Item,{label:"\u63d0\u4ea4\u6587\u7ae0"},z.a.createElement(O["a"],{onClick:this.uploadFile1},"\u9009\u62e9\u6587\u4ef6")," ",z.a.createElement("br",null),this.state.filename1,z.a.createElement("input",{type:"file",id:"uploadFile1",name:"file1",onChange:this.onFileChange1,style:{display:"none"},ref:"uploadBox1"})),z.a.createElement(L["a"].Item,{label:"\u63d0\u4ea4\u9644\u4ef6"},z.a.createElement(O["a"],{onClick:this.uploadFile2},"\u9009\u62e9\u6587\u4ef6")," ",z.a.createElement("br",null),this.state.filename2,z.a.createElement("input",{type:"file",id:"uploadFile2",name:"file2",onChange:this.onFileChange2,style:{display:"none"},ref:"uploadBox2"})),z.a.createElement(O["a"],{type:"primary",onClick:function(){F["a"].confirm({title:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",content:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",onOk:function(){e.onSubmit()}})}},"\u63d0\u4ea4"))}}]),t}(z.a.Component),o=s))||o),re=(c=L["a"].create(),c((d=function(e){function t(){var e,a;T()(this,t);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return a=q()(this,(e=A()(t)).call.apply(e,[this].concat(n))),a.onSubmit=function(){a.props.form.validateFields(function(e,t){if(!e){var i={task:a.props.task,content:"\u901a\u8fc7"};fetch("/contribute/notice",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(i)}).then(function(e){return e.json()}).then(function(e){1!=e.result?_["a"].error("\u63d0\u4ea4\u9519\u8bef"):H["a"].push("/author/result")})}})},a.onDownloadClick=function(e){e.preventDefault(),fetch("/contribute/download/id=".concat(a.state.task.id,"&type=0")).then(function(e){e.blob().then(function(t){var a=document.createElement("a");document.body.appendChild(a),a.style.display="none";var i=window.URL.createObjectURL(t);a.href=i,a.download=e.headers.get("Content-Disposition").split(";")[1].split("filename=")[1],a.click(),document.body.removeChild(a)})})},a}return V()(t,e),B()(t,[{key:"render",value:function(){var e=this;return z.a.createElement(L["a"],{layout:"vertical",hideRequiredMark:!0},z.a.createElement(L["a"].Item,{label:"\u6587\u7ae0\u5730\u5740"},z.a.createElement("a",{onClick:this.onDownloadClick},"\u4e0b\u8f7d\u6587\u7ae0")),z.a.createElement(O["a"],{type:"primary",onClick:function(){F["a"].confirm({title:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",content:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",onOk:function(){e.onSubmit()}})}},"\u786e\u8ba4"))}}]),t}(z.a.Component),p=d))||p),le=(u=L["a"].create(),u((h=function(e){function t(e){var a;return T()(this,t),a=q()(this,A()(t).call(this,e)),a.onSubmit=function(){var e=a.state.isNeedInvoice,t=a.state.filename1.substr(a.state.filename1.lastIndexOf("."));if(e)a.props.form.validateFields(function(e,i){if(!e){var n={task:a.props.task,invoice:a.props.invoice};a.state.isNeedInvoice&&(n.invoice.receipt_title=i.receipt_title,n.invoice.address=i.address,n.invoice.receiver=i.receiver,n.invoice.receipt_num=i.receipt_num,n.invoice.format=t),n.invoice.flag=1==a.state.isNeedInvoice?1:0;var r=new FormData;r.append("all",JSON.stringify(n)),r.append("file",a.state.file1),fetch("/contribute/task/fill",{method:"POST",credentials:"include",header:{"Content-Type":"multipart/form-data"},body:r}).then(function(e){return e.json()}).then(function(e){1!=e.result?_["a"].error("\u901a\u4fe1\u5931\u8d25"):H["a"].push("/author/result")})}});else if(a.state.file1){var i={task:a.props.task,invoice:a.props.invoice};i.invoice.flag=1==a.state.isNeedInvoice?1:0;var n=new FormData;n.append("all",JSON.stringify(i)),n.append("file",a.state.file1),fetch("/contribute/task/fill",{method:"POST",credentials:"include",header:{"Content-Type":"multipart/form-data"},body:n}).then(function(e){return e.json()}).then(function(e){1!=e.result?_["a"].error("\u901a\u4fe1\u5931\u8d25"):H["a"].push("/author/result")})}},a.onChange=function(e){a.setState({isNeedInvoice:e})},a.checkValue=function(e,t,i){a.state.isNeedInvoice&&!t&&i("\u8bf7\u8f93\u5165\u5fc5\u8981\u7684\u6570\u636e"),i()},a.uploadFile1=function(e){e.preventDefault(),a.refs.uploadBox1.click()},a.onFileChange1=function(e){var t=e.target.files[0];a.setState({file1:t,filename1:t?t.name:null})},a.state={isNeedInvoice:!0,file1:void 0,filename1:void 0},a}return V()(t,e),B()(t,[{key:"render",value:function(){var e=this;return z.a.createElement(L["a"],I()({},ae,{hideRequiredMark:!0}),z.a.createElement(L["a"].Item,{label:"\u7248\u9762\u8d39\u91d1\u989d"},this.props.invoice.expense),z.a.createElement(L["a"].Item,{label:"\u4e0a\u4f20\u6c47\u6b3e\u5355\u56fe\u7247"},z.a.createElement(O["a"],{onClick:this.uploadFile1},"\u9009\u62e9\u6587\u4ef6")," ",z.a.createElement("br",null),this.state.filename1,z.a.createElement("input",{type:"file",id:"uploadFile1",name:"file1",onChange:this.onFileChange1,style:{display:"none"},ref:"uploadBox1",accept:".jpg"})),z.a.createElement(L["a"].Item,{label:"\u662f\u5426\u9700\u8981\u53d1\u7968"},z.a.createElement(w["a"],{checked:this.state.isNeedInvoice,onChange:this.onChange})),z.a.createElement(L["a"].Item,{label:"\u53d1\u7968\u62ac\u5934"},this.props.form.getFieldDecorator("receipt_title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u53d1\u7968\u62ac\u5934"}]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d1\u7968\u62ac\u5934",disabled:!this.state.isNeedInvoice}))),z.a.createElement(L["a"].Item,{label:"\u7eb3\u7a0e\u4eba\u8bc6\u522b\u53f7"},this.props.form.getFieldDecorator("receipt_num",{rules:[{validator:this.checkValue}]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u7eb3\u7a0e\u4eba\u8bc6\u522b\u53f7",disabled:!this.state.isNeedInvoice}))),z.a.createElement(L["a"].Item,{label:"\u53d1\u7968\u90ae\u5bc4\u5730\u5740"},this.props.form.getFieldDecorator("address",{rules:[{validator:this.checkValue}]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d1\u7968\u90ae\u5bc4\u5730\u5740",disabled:!this.state.isNeedInvoice}))),z.a.createElement(L["a"].Item,{label:"\u53d1\u7968\u90ae\u5bc4\u6536\u4ef6\u4eba"},this.props.form.getFieldDecorator("receiver",{rules:[{validator:this.checkValue},,]})(z.a.createElement(D["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d1\u7968\u90ae\u5bc4\u6536\u4ef6\u4eba",disabled:!this.state.isNeedInvoice}))),z.a.createElement(O["a"],{type:"primary",onClick:function(){F["a"].confirm({title:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",content:"\u662f\u5426\u786e\u8ba4\u63d0\u4ea4",onOk:function(){e.onSubmit()}})}},"\u63d0\u4ea4"))}}]),t}(z.a.Component),m=h))||m),oe=(f=Object(K["connect"])(te,null),f((k=function(e){function t(e){var a;return T()(this,t),a=q()(this,A()(t).call(this,e)),a.getWriterName=function(e){var t=e;if(""==e)return"";var a=JSON.parse(t),i="",n=0;for(n=0;n<a.length-1;n++)i=i.concat(a[n].name.concat(", "));return i=i.concat(a[n].name),i},a.getOperation=function(){return a.props.step?2==a.props.step?z.a.createElement(ie,{task:a.props.task,invoice:a.props.invoice}):5==a.props.step?z.a.createElement(ne,{task:a.props.task}):8==a.props.step?z.a.createElement(re,{task:a.props.task}):9==a.props.step?z.a.createElement(le,{task:a.props.task,invoice:a.props.invoice}):null:null},a.translateAcademicSec=function(e){if(!a.props.academicSec||-1==e)return null;for(var t=0;t<a.props.academicSec.length;t++)if(a.props.academicSec[t].id==e)return a.props.academicSec[t].academicsec;return null},a.state={task:void 0,article:void 0,targetTime:void 0},a}return V()(t,e),B()(t,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"".concat($,"/queryList")});var e=W()(this.props.task?this.props.task.date:void 0).add(30,"days");this.setState({task:this.props.task,article:this.props.article,targetTime:e})}},{key:"componentWillUnmount",value:function(){var e={article:{},task:{},invoice:{},step:0};this.props.dispatch({type:"".concat(ee,"/storePublic"),payload:e})}},{key:"render",value:function(){var e=this.state?z.a.createElement(Y["a"],{className:X.a.headerList,size:"small",col:"2"},z.a.createElement(Y["a"].Description,{term:"\u4f5c\u8005"},this.getWriterName(this.state.article?this.state.article.writers_info:"")),z.a.createElement(Y["a"].Description,{term:"\u5b66\u672f\u9886\u57df"},this.translateAcademicSec(this.state.article?this.state.article.academicsec:-1)),z.a.createElement(Y["a"].Description,{term:"\u5173\u952e\u8bcd\uff08\u4e2d\u6587\uff09"},this.state.article?this.state.article.keyword1_cn:"","\xa0",this.state.article?this.state.article.keyword2_cn:"N/A","\xa0",this.state.article?this.state.article.keyword3_cn:"N/A","\xa0",this.state.article?this.state.article.keyword4_cn:"N/A"),z.a.createElement(Y["a"].Description,{term:"\u5173\u952e\u8bcd\uff08\u82f1\u6587\uff09"},this.state.article?this.state.article.keyword1_en:"","\xa0",this.state.article?this.state.article.keyword2_en:"N/A","\xa0",this.state.article?this.state.article.keyword3_en:"N/A","\xa0",this.state.article?this.state.article.keyword4_en:"N/A")):null,t=this.state?z.a.createElement(S["a"],null,z.a.createElement(C["a"],{xs:24,sm:12},z.a.createElement("div",{className:X.a.textSecondary},"\u72b6\u6001"),z.a.createElement("div",{className:X.a.heading},"\u5f85\u5ba1\u7a3f")),z.a.createElement(C["a"],{xs:24,sm:12},z.a.createElement("div",{className:X.a.textSecondary},"\u8ddd\u79bb\u622a\u6b62\u65f6\u95f4"),z.a.createElement("div",{className:X.a.heading},z.a.createElement(Z["a"],{target:this.state.targetTime})))):null;return z.a.createElement(G["a"],{title:"\u6587\u7ae0\u6807\u9898\uff1a".concat(this.state.article?this.state.article.title:""),logo:z.a.createElement("img",{alt:"",src:"https://gw.alipayobjects.com/zos/rmsportal/nxkuOJlFJuAUhzlMTCEe.png"}),content:e,extraContent:t},z.a.createElement(b["a"],{title:"\u4e2d\u6587\u6458\u8981",style:{marginBottom:24},bordered:!1},this.state.article?this.state.article.summary_cn:""),z.a.createElement(b["a"],{title:"\u6d41\u7a0b\u8fdb\u5ea6",style:{marginBottom:24},bordered:!1},z.a.createElement(y["a"],g()({progressDot:!0,direction:"horizontal",current:this.props.step?this.props.step:0},"direction","vertical"),z.a.createElement(y["a"].Step,{title:"\u63d0\u4ea4\u7a3f\u4ef6",description:"\u7a3f\u4ef6\u63d0\u4ea4\u5b8c\u6bd5"}),z.a.createElement(y["a"].Step,{title:"\u7f16\u8f91\u521d\u5ba1",description:"\u7f16\u8f91\u5bf9\u7a3f\u4ef6\u8fdb\u884c\u521d\u5ba1"}),z.a.createElement(y["a"].Step,{title:"\u7f34\u7eb3\u5ba1\u7a3f\u8d39",description:"\u901a\u8fc7\u521d\u5ba1\u7684\u7a3f\u4ef6\u7f34\u7eb3\u5ba1\u7a3f\u8d39"}),z.a.createElement(y["a"].Step,{title:"\u5ba1\u7a3f\u4e2d",description:"\u7f16\u8f91\u90e8\u53ca\u5ba1\u7a3f\u4eba\u5728\u5bf9\u60a8\u7684\u7a3f\u4ef6\u8fdb\u884c\u5ba1\u9605"}),z.a.createElement(y["a"].Step,{title:"\u5ba1\u7a3f\u7ed3\u8bba\u53cd\u9988",description:"\u7f16\u8f91\u90e8\u5df2\u53cd\u9988\u5ba1\u7a3f\u610f\u89c1"}),z.a.createElement(y["a"].Step,{title:"\u4fee\u6539",description:"\u6839\u636e\u5ba1\u7a3f\u610f\u89c1\u8fdb\u884c\u4fee\u6539"}),z.a.createElement(y["a"].Step,{title:"\u4e8c\u6b21\u5ba1\u9605",description:"\u7f16\u8f91\u90e8\u53ca\u5ba1\u7a3f\u4eba\u5728\u5bf9\u60a8\u7684\u7a3f\u4ef6\u8fdb\u884c\u5ba1\u9605"}),z.a.createElement(y["a"].Step,{title:"\u5ba1\u7a3f\u7ed3\u8bba\u53cd\u9988",description:"\u7f16\u8f91\u90e8\u5df2\u53cd\u9988\u5ba1\u7a3f\u610f\u89c1"}),z.a.createElement(y["a"].Step,{title:"\u5f85\u786e\u8ba4\u4fee\u6539",description:"\u5f85\u786e\u8ba4\u7f16\u8f91\u7684\u683c\u5f0f\u4fee\u6539"}),z.a.createElement(y["a"].Step,{title:"\u7f34\u7eb3\u7248\u9762\u8d39",description:"\u5bf9\u6700\u7ec8\u7a3f\u4ef6\u7f34\u7eb3\u7248\u9762\u8d39"}),z.a.createElement(y["a"].Step,{title:"\u5b8c\u6210",description:"\u6d41\u7a0b\u5df2\u5b8c\u6210"}))),z.a.createElement(b["a"],{title:"\u64cd\u4f5c",style:{marginBottom:24},bordered:!1},this.getOperation()))}}]),t}(z.a.Component),v=k))||v);t["default"]=oe},tpv8:function(e,t,a){e.exports={headerList:"antd-pro-pages-author-task-detail-headerList",tabsCard:"antd-pro-pages-author-task-detail-tabsCard",noData:"antd-pro-pages-author-task-detail-noData",heading:"antd-pro-pages-author-task-detail-heading",stepDescription:"antd-pro-pages-author-task-detail-stepDescription",textSecondary:"antd-pro-pages-author-task-detail-textSecondary"}}}]);