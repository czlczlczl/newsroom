(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[77],{M9EE:function(e,a,t){"use strict";t.r(a);t("IzEo");var n,r,s,l,o,c,i,u=t("bx4M"),d=(t("14J3"),t("BMrR")),m=(t("jCWc"),t("kPKH")),p=(t("miYZ"),t("tsqr")),f=(t("FJo9"),t("L41K")),h=(t("+L6B"),t("2/Rp")),g=(t("7Kak"),t("9yH6")),E=(t("/zsF"),t("PArb")),v=t("jehZ"),y=t.n(v),b=(t("Q9mQ"),t("diRs")),w=(t("5NDa"),t("5rEg")),k=t("p0pE"),q=t.n(k),S=(t("MXD1"),t("CFYs")),V=t("2Taf"),A=t.n(V),C=t("vZ4D"),F=t.n(C),I=t("l4Ni"),R=t.n(I),P=t("ujKo"),L=t.n(P),M=t("MhPg"),x=t.n(M),D=(t("y8nQ"),t("Vl3Y")),Q=(t("2qtc"),t("kLXV")),N=t("q1tI"),T=t.n(N),U=t("MuoO"),B=t("usdK"),O=t("CkN6"),j=t("zHco"),z=t("ajhq"),K=t.n(z),J="userManageEditorList",Z=function(e){var a=e[J].pageBean,t=e[J].rows,n=e[J].loading;return{loading:n,pageBean:a,rows:t}},H=function(e,a){var t=e.map(function(e){return e.username}),n=t.join(", ");Q["a"].confirm({title:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u4ee5\u4e0b\u89d2\u8272",content:n,okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){a(e)}})},Y=function(e,a){var t=e.map(function(e){return e.username}),n=t.join(", ");Q["a"].confirm({title:"\u8bf7\u786e\u8ba4\u91cd\u7f6e\u4ee5\u4e0b\u89d2\u8272\u7684\u5bc6\u7801\uff08\u91cd\u7f6e\u4e3a12345678\uff09\uff1a",content:n,okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){a(e)}})},W={good:T.a.createElement("div",{className:K.a.success},"\u5f3a\u5ea6\uff1a\u5f3a"),ok:T.a.createElement("div",{className:K.a.warning},"\u5f3a\u5ea6\uff1a\u4e2d"),poor:T.a.createElement("div",{className:K.a.error},"\u5f3a\u5ea6\uff1a\u5f31")},X={good:"success",ok:"normal",poor:"exception"},G={labelCol:{span:7},wrapperCol:{span:13}},$=(n=D["a"].create(),n((s=function(e){function a(e){var t;return A()(this,a),t=R()(this,L()(a).call(this,e)),t.getPasswordStrengthLevel=function(){var e=t.props.form.getFieldValue("password"),a=/^\w*[A-Z]+\w*/,n=/^\w+/;return e&&e.length>15&&a.test(e)?"good":e&&e.length>=10&&n.test(e)?"ok":"poor"},t.checkPassword=function(e,a,n){if(a?t.setState({visable:!!a}):(t.setState({help:"\u8bf7\u8f93\u5165\u65b0\u7684\u5bc6\u7801",visable:!!a}),n("\u8bf7\u8f93\u5165\u5bc6\u7801")),a.length<10)n("\u5bc6\u7801\u957f\u5ea6\u8bf7\u5927\u4e8e\u7b49\u4e8e10\u4f4d");else{var r=t.props.form;a&&t.state.confirmDirty&&r.validateFields(["confirm"],{force:!0}),n()}},t.getProgressPercent=function(e){var a=X[t.getPasswordStrengthLevel()];return"exception"==a?20:"normal"==a?60:"success"==a?100:0},t.renderPasswordStrength=function(){var e=t.props.form,a=e.getFieldValue("password"),n=t.getPasswordStrengthLevel();return a&&a.length?T.a.createElement("div",{className:K.a["progress-".concat(n)]},T.a.createElement(S["a"],{status:X[n],className:K.a.progress,strokeWidth:6,percent:t.getProgressPercent(a),showInfo:!1})):null},t.checkConfirm=function(e,a,n){a&&a!==t.props.form.getFieldValue("password")?n("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"):n()},t.handleNext=function(e){var a=t.props,n=a.form,r=a.handleAdd,s=t.state.formVals;n.validateFields(function(a,n){if(!a){var l=q()({},s,n);t.setState({formVals:l},function(){e<2?t.forward():r(l)})}})},t.backward=function(){var e=t.state.currentStep;t.setState({currentStep:e-1})},t.forward=function(){var e=t.state.currentStep;t.setState({currentStep:e+1})},t.renderContent=function(e,a){var n=t.props.form.getFieldDecorator;return 1===e?[T.a.createElement(D["a"].Item,y()({},G,{label:"\u5bc6\u7801"}),T.a.createElement(b["a"],{getPopupContainer:function(e){return e.parentNode},content:T.a.createElement("div",{style:{padding:"4px 0"}},W[t.getPasswordStrengthLevel()],t.renderPasswordStrength(),T.a.createElement("div",{style:{marginTop:10}},"\u8bf7\u8f93\u5165\u81f3\u5c1110\u4e2a\u5b57\u7b26\u7684\u5bc6\u7801\uff0c\u5305\u62ec\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u5efa\u8bae\u5305\u542b\u5927\u5199\u5b57\u6bcd\u3002")),overlayStyle:{width:240},placement:"right",visible:t.state.visible},n("password",{rules:[{validator:t.checkPassword}]})(T.a.createElement(w["a"],{type:"password",placeholder:"\u81f3\u5c1110\u4e2a\u5b57\u7b26\uff0c\u5305\u62ec\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u5efa\u8bae\u5305\u542b\u5927\u5199\u5b57\u6bcd\u3002"})))),T.a.createElement(D["a"].Item,y()({},G,{label:"\u91cd\u590d\u8f93\u5165\u5bc6\u7801"}),n("confirm",{rules:[{required:!0,message:"\u9700\u8981\u518d\u8f93\u5165\u4e00\u6b21\u5bc6\u7801"},{validator:t.checkConfirm}]})(T.a.createElement(w["a"],{type:"password",placeholder:"\u8bf7\u8f93\u5165\u786e\u8ba4\u5bc6\u7801"})))]:2===e?[T.a.createElement(D["a"].Item,y()({},G,{label:"\u5b89\u5168\u95ee\u9898\u9898\u76ee1"}),n("safequeQ1",{initialValue:a.safequeQ1,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98981\u7684\u9898\u76ee"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98981\u7684\u9898\u76ee"}))),T.a.createElement(D["a"].Item,y()({},G,{label:"\u5b89\u5168\u95ee\u9898\u7b54\u68481"}),n("safequeA1",{initialValue:a.safequeA1,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98981\u7684\u7b54\u6848"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98981\u7684\u7b54\u6848"}))),T.a.createElement(E["a"],null),T.a.createElement(D["a"].Item,y()({},G,{label:"\u5b89\u5168\u95ee\u9898\u9898\u76ee2"}),n("safequeQ2",{initialValue:a.safequeQ2,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98982\u7684\u9898\u76ee"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98982\u7684\u9898\u76ee"}))),T.a.createElement(D["a"].Item,y()({},G,{label:"\u5b89\u5168\u95ee\u9898\u7b54\u68482"}),n("safequeA2",{initialValue:a.safequeA2,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98982\u7684\u7b54\u6848"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98982\u7684\u7b54\u6848"}))),T.a.createElement(E["a"],null),T.a.createElement(D["a"].Item,y()({},G,{label:"\u5b89\u5168\u95ee\u9898\u9898\u76ee3"}),n("safequeQ3",{initialValue:a.safequeQ3,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98983\u7684\u9898\u76ee"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98983\u7684\u9898\u76ee"}))),T.a.createElement(D["a"].Item,y()({},G,{label:"\u5b89\u5168\u95ee\u9898\u7b54\u68483"}),n("safequeA3",{initialValue:a.safequeA3,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98983\u7684\u7b54\u6848"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u5b89\u5168\u95ee\u98983\u7684\u7b54\u6848"})))]:[T.a.createElement(D["a"].Item,y()({},G,{label:"\u7528\u6237\u540d\uff1a"}),n("username",{initialValue:a.username,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}))),T.a.createElement(D["a"].Item,y()({},G,{label:"\u59d3\u540d"}),n("name",{initialValue:a.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u59d3\u540d"}]})(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d"}))),T.a.createElement(D["a"].Item,y()({},G,{label:"\u6027\u522b"}),n("gender",{initialValue:a.gender,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6027\u522b"}]})(T.a.createElement(g["a"].Group,null,T.a.createElement(g["a"],{value:1},"\u7537"),T.a.createElement(g["a"],{value:2},"\u5973"))))]},t.renderFooter=function(e){var a=t.props,n=a.handleAddModalVisible,r=a.values;return 1===e?[T.a.createElement(h["a"],{key:"back",style:{float:"left"},onClick:t.backward},"\u4e0a\u4e00\u6b65"),T.a.createElement(h["a"],{key:"cancel",onClick:function(){return n(!1,r)}},"\u53d6\u6d88"),T.a.createElement(h["a"],{key:"forward",type:"primary",onClick:function(){return t.handleNext(e)}},"\u4e0b\u4e00\u6b65")]:2===e?[T.a.createElement(h["a"],{key:"back",style:{float:"left"},onClick:t.backward},"\u4e0a\u4e00\u6b65"),T.a.createElement(h["a"],{key:"cancel",onClick:function(){return n(!1,r)}},"\u53d6\u6d88"),T.a.createElement(h["a"],{key:"submit",type:"primary",onClick:function(){return t.handleNext(e)}},"\u5b8c\u6210")]:[T.a.createElement(h["a"],{key:"cancel",onClick:function(){return n(!1,r)}},"\u53d6\u6d88"),T.a.createElement(h["a"],{key:"forward",type:"primary",onClick:function(){return t.handleNext(e)}},"\u4e0b\u4e00\u6b65")]},t.state={formVals:{username:e.values.username,password:e.values.password,name:e.values.name,gender:e.values.gender,safequeQ1:e.values.safequeQ1,safequeA1:e.values.safequeA1,safequeQ2:e.values.safequeQ2,safequeA2:e.values.safequeA2,safequeQ3:e.values.safequeQ3,safequeA3:e.values.safequeA3},currentStep:0,visible:!1},t}return x()(a,e),F()(a,[{key:"render",value:function(){var e=this;return this.props.isAddSuccess&&(this.setState({formVals:{},currentStep:0,visible:!1}),this.props.handleChangeIsAddSuccess(!1)),T.a.createElement(Q["a"],{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u6dfb\u52a0\u65b0\u7f16\u8f91",visible:this.props.addModalVisible,footer:this.renderFooter(this.state.currentStep),onCancel:function(){return e.props.handleAddModalVisible(!1,e.props.values)},afterClose:function(){e.props.handleAddModalVisible()}},T.a.createElement(f["a"],{style:{marginBottom:28},size:"small",current:this.state.currentStep},T.a.createElement(f["a"].Step,{title:"\u57fa\u672c\u4fe1\u606f"}),T.a.createElement(f["a"].Step,{title:"\u8bbe\u7f6e\u5bc6\u7801"}),T.a.createElement(f["a"].Step,{title:"\u8bbe\u7f6e\u5b89\u5168\u95ee\u9898"})),this.renderContent(this.state.currentStep,this.state.formVals))}}]),a}(T.a.Component),r=s))||r),_=(l=Object(U["connect"])(Z,null),o=D["a"].create(),l(c=o((i=function(e){function a(e){var t;return A()(this,a),t=R()(this,L()(a).call(this,e)),t.getEditorItem=function(e){B["a"].push("/userdetail/editor/".concat(e))},t.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username",render:function(e){return T.a.createElement("a",{onClick:function(){return t.getEditorItem(e)}},e)}},{title:"\u59d3\u540d",dataIndex:"name"},{title:"\u6027\u522b",dataIndex:"gender",render:function(e){return 1==e?"\u7537":"\u5973"}},{title:"\u64cd\u4f5c",render:function(e,a){return T.a.createElement(N["Fragment"],null,T.a.createElement("a",{onClick:function(){return t.handleResetPasswordOneLine(a)}},"\u91cd\u7f6e\u5bc6\u7801"),T.a.createElement(E["a"],{type:"vertical"}),T.a.createElement("a",{onClick:function(){return t.handleDeleteRecordOneLine(!0,a)}},"\u5220\u9664"))}}],t.handleAddModalVisible=function(e,a){t.setState({addModalVisible:!!e,stepFormValues:a||{}})},t.resetUserFunc=function(e){for(var a=function(a){var n={username:e[a].username,role:3};t.props.dispatch({type:"".concat(J,"/resetPw"),payload:n,callback:function(e){1!=e.result&&p["a"].error("\u5bc6\u7801\u91cd\u7f6e\u5931\u8d25\uff1a".concat(n.username))}})},n=0;n<e.length;n++)a(n)},t.handleResetPasswordOneLine=function(e){Y([e],t.resetUserFunc)},t.handleResetPasswordLines=function(e){e.preventDefault(),Y(t.state.selectedRows,t.resetUserFunc)},t.deleteUserFunc=function(e){new Promise(function(a,n){for(var r=function(a){var n={usernameToDelete:e[a].username,role:3};t.props.dispatch({type:"".concat(J,"/deleteOneUser"),payload:n,callback:function(e){1!=e.result&&p["a"].error("\u7528\u6237\u5220\u9664\u5931\u8d25\uff1a".concat(n.usernameToDelete))}})},s=0;s<e.length;s++)r(s);a()}).then(function(){var e={role:3,username:t.state.formValues.username,name:t.state.formValues.name,page:t.props.pageBean.currentPage};t.props.dispatch({type:"".concat(J,"/queryUser"),payload:e})})},t.handleDeleteRecordOneLine=function(e,a){t.setState({oneLineDeleteModalVisible:!!e,oneLineRecordValue:a||{}}),H([a],t.deleteUserFunc)},t.handleDeleteRecordLines=function(e){e.preventDefault(),H(t.state.selectedRows,t.deleteUserFunc)},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var n=q()({},a);t.setState({formValues:n});var r=q()({},n,{page:1,role:3});t.props.dispatch({type:"".concat(J,"/queryUser"),payload:r})}})},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:{}});var e={page:1,role:3};t.props.dispatch({type:"".concat(J,"/queryUser"),payload:e})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleChangeIsAddSuccess=function(e){t.setState({isAddSuccess:e})},t.handleAdd=function(e){var a=!1,n={body:{username:e.username,password:e.password,name:e.name,gender:e.gender,safeque1:e.safequeQ1.concat(";").concat(e.safequeA1),safeque2:e.safequeQ2.concat(";").concat(e.safequeA2),safeque3:e.safequeQ3.concat(";").concat(e.safequeA3),alive:1},role:3};return t.props.dispatch({type:"".concat(J,"/addEditor"),payload:n,callback:function(e){if(1!=e.result)p["a"].error("\u6dfb\u52a0\u9519\u8bef");else{p["a"].success("\u6dfb\u52a0\u6210\u529f"),t.handleAddModalVisible(),t.handleChangeIsAddSuccess(!0);var a={role:1,username:t.state.formValues.username,name:t.state.formValues.name,page:t.props.pageBean.currentPage};t.props.dispatch({type:"".concat(J,"/queryUser"),payload:a})}}}),a},t.handleStandardTableChange=function(e,a,n){var r=t.props.dispatch,s=t.state.formValues,l=q()({role:3,page:e.current},s);r({type:"".concat(J,"/queryUser"),payload:l})},t.state={modalVisible:!1,addModalVisible:!1,expandForm:!1,selectedRows:[],formValues:{},stepFormValues:{},isAddSuccess:!1,oneLineDeleteModalVisible:{},oneLineRecordValue:{}},t}return x()(a,e),F()(a,[{key:"componentDidMount",value:function(){var e={role:3,page:1};this.props.dispatch({type:"".concat(J,"/queryUser"),payload:e})}},{key:"renderForm",value:function(){var e=this.props.form.getFieldDecorator;return T.a.createElement(D["a"],{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement(d["a"],{gutter:{md:8,lg:24,xl:48}},T.a.createElement(m["a"],{md:8,sm:24},T.a.createElement(D["a"].Item,{label:"\u7528\u6237\u540d"},e("username")(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})))),T.a.createElement(m["a"],{md:8,sm:24},T.a.createElement(D["a"].Item,{label:"\u59d3\u540d"},e("name")(T.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d"})))),T.a.createElement(m["a"],{md:8,sm:24},T.a.createElement("span",{className:K.a.submitButtons},T.a.createElement(h["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),T.a.createElement(h["a"],{style:{marginLeft:8},onClick:this.handleFormReset},"\u6e05\u7a7a")))))}},{key:"render",value:function(){var e=this,a={list:this.props.rows,pagination:{total:this.props.pageBean?this.props.pageBean.total:0,pageSize:10,current:this.props.pageBean?this.props.pageBean.currentPage:1}},t={handleAddModalVisible:this.handleAddModalVisible,handleAdd:this.handleAdd},n=this.props.loading;return T.a.createElement(j["a"],{title:"\u7f16\u8f91\u7ba1\u7406"},T.a.createElement(u["a"],{bordered:!1},T.a.createElement("div",{className:K.a.tableList},T.a.createElement("div",{className:K.a.tableListForm},this.renderForm()),T.a.createElement("div",{className:K.a.tableListOperator},T.a.createElement(h["a"],{icon:"plus",type:"primary",onClick:function(){return e.handleAddModalVisible(!0)}},"\u65b0\u589e\u7f16\u8f91"),this.state.selectedRows.length>0&&T.a.createElement("span",null,T.a.createElement(h["a"],{onClick:this.handleDeleteRecordLines},"\u6279\u91cf\u5220\u9664"),T.a.createElement(h["a"],{onClick:this.handleResetPasswordLines},"\u6279\u91cf\u91cd\u7f6e"))),T.a.createElement(O["a"],{selectedRows:this.state.selectedRows,loading:n,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,useSelectionRow:!0}))),T.a.createElement($,y()({},t,{addModalVisible:this.state.addModalVisible,values:this.state.stepFormValues,isAddSuccess:this.state.isAddSuccess,handleChangeIsAddSuccess:this.handleChangeIsAddSuccess})))}}]),a}(T.a.Component),c=i))||c)||c);a["default"]=_}}]);